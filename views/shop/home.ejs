<%- include('../partials/header') %>
<%- include("../partials/navbar") %>

<style>
    /* üåü Product Grid Styling */
    .product-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 25px;
        padding: 30px;
        max-width: 1300px;
        margin: auto;
    }

    .product-card {
        background: white;
        padding: 12px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .product-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 6px 16px rgba(0,0,0,0.15);
    }

    /* üåü Image Frame */
    .product-img-wrapper {
        width: 100%;
        height: 220px; 
        border-radius: 10px;
        overflow: hidden; /* stays inside frame */
        background: #f3f3f3;
    }

    .product-img-wrapper img {
        width: 100%;
        height: 100%;
        object-fit: cover; /* üî• keeps image perfect */
        transition: transform 0.25s ease;
    }

    .product-img-wrapper:hover img {
        transform: scale(1.05); /* subtle zoom effect */
    }
</style>

<!-- üîç Search Bar -->
<div style="text-align:center;margin-top:25px;">
    <form action="/" method="GET" style="display:inline-flex;gap:10px;">
        <input type="text" name="search" value="<%= search %>" 
               placeholder="Search products..."
               style="padding:10px 15px;width:280px;border:1px solid #ccc;border-radius:5px;font-size:16px;">
        
        <button type="submit" 
                style="padding:10px 20px;background:#007bff;color:white;border:none;border-radius:5px;cursor:pointer;">
            Search
        </button>
    </form>
</div>

<h2 style="text-align:center;margin-top:20px;font-size:26px;">Our Products</h2>

<!-- üõí Product Grid -->
<div class="product-grid">
    <% products.forEach(p => { %>
        <div class="product-card">
            <a href="/product/<%= p.id %>" style="text-decoration:none;color:black;">
                
                <div class="product-img-wrapper">
                    <img src="<%= p.image && (p.image.startsWith('http') || p.image.startsWith('https')) 
                                ? p.image 
                                : '/uploads/' + p.image %>"
                         alt="<%= p.name %>">
                </div>

                <h3 style="font-size:17px;margin:8px 0;"><%= p.name %></h3>
                <p style="font-weight:bold;color:#007bff;">Rs <%= p.price %></p>
            </a>

            <form action="/add-to-cart/<%= p.id %>" method="POST">
                <button style="background:#007bff;color:white;padding:8px 12px;border:none;border-radius:5px;cursor:pointer;width:100%;">
                    Add to Cart
                </button>
            </form>
        </div>
    <% }) %>
</div>

<!-- üìå Pagination -->
<div style="text-align:center;margin:30px 0;">
    <% if (page > 1) { %>
        <a href="/?page=<%= page - 1 %>" 
           style="padding:8px 14px;border:1px solid #444;margin-right:10px;border-radius:5px;text-decoration:none;">
           ‚¨Ö Previous
        </a>
    <% } %>

    <span style="margin:0 10px;font-weight:bold;font-size:18px;">
        Page <%= page %> of <%= totalPages %>
    </span>

    <% if (page < totalPages) { %>
        <a href="/?page=<%= page + 1 %>" 
           style="padding:8px 14px;border:1px solid #444;margin-left:10px;border-radius:5px;text-decoration:none;">
           Next ‚ûù
        </a>
    <% } %>
</div>

<%- include('../partials/footer') %>
