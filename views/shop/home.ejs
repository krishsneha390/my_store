<%- include('../partials/header') %>

<!-- üîç Search Bar -->
<div style="text-align:center;margin-top:25px;">
    <form action="/" method="GET" style="display:inline-flex;gap:10px;">
        <input type="text" name="search" value="<%= search %>" 
               placeholder="Search products..."
               style="padding:10px 15px;width:280px;border:1px solid #ccc;border-radius:5px;font-size:16px;">
        
        <button type="submit" 
                style="padding:10px 20px;background:#007bff;color:white;border:none;border-radius:5px;cursor:pointer;">
            Search
        </button>
    </form>
</div>

<h2 style="text-align:center;margin-top:20px;font-size:26px;">Our Products</h2>

<!-- üõí Product Grid -->
<div class="product-grid" style="padding:20px;">
    <% products.forEach(p => { %>
        <div class="product-card">
            <a href="/product/<%= p.id %>" style="text-decoration:none;color:black;">
                <div class="product-img-wrapper">
                    <img src="<%= p.image && (p.image.startsWith('http') || p.image.startsWith('https')) 
                                ? p.image 
                                : '/uploads/' + p.image %>"
                         alt="<%= p.name %>" 
                         style="width:100%;height:220px;object-fit:cover;border-radius:6px;">
                </div>

                <h3 style="font-size:17px;margin:8px 0;"><%= p.name %></h3>
                <p style="font-weight:bold;color:#007bff;">Rs <%= p.price %></p>
            </a>

            <form action="/add-to-cart/<%= p.id %>" method="POST">
                <button style="background:#007bff;color:white;padding:8px 12px;border:none;border-radius:5px;cursor:pointer;">
                    Add to Cart
                </button>
            </form>
        </div>
    <% }) %>
</div>


<!-- üìå Pagination -->
<div style="text-align:center;margin:30px 0;">
    <% if (page > 1) { %>
        <a href="/?page=<%= page - 1 %>" 
           style="padding:8px 14px;border:1px solid #444;margin-right:10px;border-radius:5px;text-decoration:none;">
           ‚¨Ö Previous
        </a>
    <% } %>

    <span style="margin:0 10px;font-weight:bold;font-size:18px;">
        Page <%= page %> of <%= totalPages %>
    </span>

    <% if (page < totalPages) { %>
        <a href="/?page=<%= page + 1 %>" 
           style="padding:8px 14px;border:1px solid #444;margin-left:10px;border-radius:5px;text-decoration:none;">
           Next ‚ûù
        </a>
    <% } %>
</div>


<%- include('../partials/footer') %>
