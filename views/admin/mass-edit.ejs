<%- include('../partials/header') %>

<h2 style="margin-bottom:15px; font-size:24px; font-weight:bold;">‚úè Mass Edit Products</h2>

<form action="/admin/mass-edit/update" method="POST">


<table border="1" cellpadding="8" width="100%"
style="border-collapse:collapse; font-size:15px; text-align:left;">

<tr style="background:black; color:white; font-weight:bold; text-align:center;">
    <th style="width:4%;">ID</th>
    <th style="width:28%;">Name</th>
    <th style="width:10%;">Price</th>
    <th style="width:12%;">Category</th>
    <th style="width:30%;">Description</th>
    <th style="width:16%;">Image</th>
</tr>

<% products.forEach((p,i)=>{ %>
<tr>

    <!-- ID -->
    <td style="text-align:center;">
        <%= p.id %>
        <input type="hidden" name="id[]" value="<%= p.id %>">
    </td>

    <!-- Name (Multi-line & bigger) -->
    <td>
        <textarea name="name[]" 
        style="width:100%; padding:6px; height:60px; resize:vertical; 
               word-wrap:break-word; font-size:14px;"><%= p.name %></textarea>
    </td>

    <!-- Price -->
    <td>
        <input type="number" name="price[]"
        value="<%= p.price %>"
        style="width:100%; padding:6px; font-size:14px;">
    </td>

    <!-- Category dropdown -->
    <td>
        <select name="category_id[]" style="width:100%; padding:6px; font-size:14px;">
            <% categories.forEach(c=>{ %>
                <option value="<%= c.id %>" <%= p.category_id==c.id?'selected':'' %>>
                    <%= c.name %>
                </option>
            <% }) %>
        </select>
    </td>

    <!-- Description -->
    <td>
        <textarea name="description[]" 
        style="width:100%; height:70px; padding:6px; font-size:14px; resize:vertical;"><%= p.description %></textarea>
    </td>

    <!-- Image preview + URL editable -->
    <td>
        <img src="<%= p.image.includes('/uploads') ? p.image : '/uploads/' + p.image %>" 
             width="65" style="display:block;margin-bottom:5px;border-radius:5px;">

        <input type="text" name="image[]"
        value="<%= p.image %>"
        style="width:100%; padding:5px; font-size:14px;">
    </td>

</tr>
<% }) %>

</table>

<br>

<!-- Pagination Buttons -->
<div style="text-align:center;margin-bottom:20px;">

    <% if(page > 1){ %>
        <a href="/admin/mass-edit?page=<%= page-1 %>"
        style="padding:8px 16px;background:#222;color:white;border-radius:5px;text-decoration:none;margin-right:8px;">
            ‚¨Ö Previous
        </a>
    <% } %>

    <span style="font-size:18px;margin:0 12px;">
        Page <%= page %> of <%= totalPages %>
    </span>

    <% if(page < totalPages){ %>
        <a href="/admin/mass-edit?page=<%= page+1 %>"
        style="padding:8px 16px;background:#222;color:white;border-radius:5px;text-decoration:none;margin-left:8px;">
            Next ‚û°
        </a>
    <% } %>

</div>

<!-- Save Button -->
<div style="text-align:center;">
    <button type="submit"
    style="padding:12px 30px; background:green; color:white; font-size:18px; 
           font-weight:bold; border-radius:6px; cursor:pointer;">
        üíæ Save All Changes
    </button>
</div>

</form>

<br><br>

<%- include('../partials/footer') %>
